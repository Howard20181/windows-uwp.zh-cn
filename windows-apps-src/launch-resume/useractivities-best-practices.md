---
title: 用户活动的最佳做法
description: 本指南概述了创建和更新用户活动的建议做法。
keywords: 用户活动, 时间线, cortana 从你离开的位置继续, cortana 从我离开的位置继续, project rome
ms.date: 08/23/2018
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: f4e41ac4f340491e551fccc1c1d4700bbe8d8004
ms.sourcegitcommit: 7b2febddb3e8a17c9ab158abcdd2a59ce126661c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/31/2020
ms.locfileid: "89172951"
---
# <a name="user-activities-best-practices"></a>用户活动的最佳做法

本指南概述了创建和更新用户活动的建议做法。 有关 Windows 上的用户活动功能的概述，请参阅 [继续用户活动，甚至跨设备](./useractivities.md)。 或者，若要在其他开发平台上实现活动，请参阅 Project 罗马的 [用户活动部分](/windows/project-rome/user-activities/) 。

## <a name="when-to-create-or-update-user-activities"></a>何时创建或更新用户活动

由于每个应用程序都不同，因此，每个开发人员都需要确定在应用程序中将操作映射到用户活动的最佳方式。 你的用户活动将被展示到 Cortana 和时间线中，这些活动侧重于提高用户的工作效率和效率，因为它可以帮助他们返回过去访问的内容。

**一般准则**

* **记录一组相关用户操作的单个活动。** 这尤其适用于音乐播放列表或电视节目：可以定期更新单个活动，以反映用户的进度。 在这种情况下，你将拥有一个具有多个历史记录项的单一用户活动，这些项表示跨多天或几周的参与时间。 这同样适用于基于文档的活动，用户在应用程序中对其进行逐步进度。
* **将用户数据存储在云中。** 如果你想要支持跨设备活动，则需要确保将此活动重新操作所需的内容存储到云位置。 设备特定的活动将显示在创建活动的设备上的时间线上，但不会显示在其他设备上。
* **不要为用户无需恢复的操作创建活动。** 如果你的应用程序用于完成不保持状态的简单的一次性操作，则你可能不需要创建用户活动。
* **不要为其他用户完成的操作创建活动。** 如果外部帐户在你的应用中向用户发送消息或消息 @-mentions ，则不应为此创建活动。 操作中心通知更好地提供此类型的操作。
  * 协作方案是一种例外情况：如果多个用户在同一活动 (如 Word 文档) ，则在某些情况下，另一个用户已在用户进行更改。 在这种情况下，您可能希望更新现有活动，以反映对文档所做的更改。 这涉及到更新现有的用户活动内容数据，而不创建新的历史记录项。

**特定类型应用的准则**

虽然每个应用程序都不同，但大多数应用程序都属于以下交互模式之一。
* **基于文档的应用** -为每个文档创建一个活动，其中包含一个或多个反映使用时间的历史记录项。 在对文档进行更改时更新活动非常重要。
* **游戏** -为每个游戏保存或世界创建一个活动。 如果游戏仅支持一系列级别，则可在一段时间内重新发布同一活动，但你可能想要更新内容数据以显示最新进度或成就。
* **实用工具应用** —如果你的应用程序中没有用户需要保留和恢复的内容，则不需要使用用户活动。 一个很好的示例是计算器等简单应用。
* **业务线应用** —存在许多用于管理简单任务或工作流的应用。 为通过您的应用程序访问的每个单独的工作流创建一个活动 (例如，支出报表每个都是单独的活动，这样用户就可以单击某个活动来查看是否) 批准了特定的报表。
* **媒体播放应用** -为每个逻辑分组（如播放列表、程序或独立 (的内容) ）创建一个活动。 应用开发人员的基本问题在于，每条内容 (电视节目，歌曲) 计为独立内容或部分集合。 一般规则是，如果用户想要播放集合或顺序内容，作为一个整体的集合就是活动。 如果他们选择播放一段内容，则这一项内容就是活动。 请参阅下面更具体的指南。
  * **音乐：唱片集/艺术家/流派** -如果用户选择唱片集、 **艺术家、流派和点击次数**，该集合就是活动;不要为每首歌曲编写单独的活动。 对于较短的集合（如按随机顺序播放的单个唱片集或集合），您可能不需要更新活动以反映用户的当前位置。 对于长顺序播放（例如唱片集或播放列表），记录你在唱片集中的位置可能有意义。
  * **音乐：智能播放列表** -以随机顺序播放音乐的应用程序应记录该播放列表的单个活动。 如果用户第二次播放播放列表，则会为同一活动创建其他历史记录。 不需要记录用户在播放列表中的当前位置，因为顺序是随机的。
  * **电视系列** -如果你的应用程序配置为在完成当前操作后播放下一个剧集，你应该为电视系列编写一个活动。 当您在多个查看会话中播放各个剧集时，您将更新活动以反映序列中的当前位置，并创建多个历史记录。
  * **电影** -电影是一段内容，应该有自己的历史记录。 如果用户停止观看电影，则需要记录其位置。 如果他们想要在将来恢复它，活动可以在其停止的位置恢复电影，甚至会询问用户是否想要在开始时继续或从头开始。

## <a name="user-activity-design"></a>用户活动设计

用户活动由三个组件组成：激活 URI、可视数据和内容元数据。
* 激活 URI 是一个 URI，可传递给应用程序或体验以便使用特定上下文恢复应用程序。 通常，这些链接采用方案的协议处理程序的形式 (例如，"//page2" ) 。 开发人员需要确定如何通过应用程序处理 URI 参数。 有关详细信息，请参阅 [处理 URI 激活](./handle-uri-activation.md) 。
* 可视化数据由一组必需的和可选的属性组成 (例如：标题、说明或自适应卡元素) ，允许用户直观地识别活动。 请参阅下面的指南，了解如何为活动创建自适应卡视觉对象。
* 内容元数据是可用于分组和检索特定上下文中的活动的 JSON 数据。 通常，这会采用数据形式 http://schema.org 。 有关填写此数据的指南，请参阅下文。

### <a name="adaptive-card-design-guidelines"></a>自适应卡设计准则

当活动显示在时间线中时，它们使用 [自适应卡框架](/adaptive-cards/)显示。 如果开发人员没有为每个活动都提供自适应卡，则时间线会根据应用程序名称/图标、所需标题字段和可选说明字段自动创建一个简单卡。 

鼓励应用开发人员使用简单的自适应卡 JSON 架构来提供自定义卡。 请参阅 [自适应卡文档](/adaptive-cards/authoring-cards/getting-started) ，获取有关如何构造自适应卡对象的技术说明。 请参阅下面的指导原则，以在用户活动中设计自适应卡。
* 使用图像
  * 如果可能，请为每个活动使用唯一的映像。 您的应用程序名称和图标会自动显示在活动卡的旁边;其他映像将帮助用户找到要查找的活动。
  * 图像不应包含用户应阅读的文本。 此文本不适用于具有辅助功能需求的用户，无法进行搜索。
  * 如果图像不包含文本并且可以裁剪到约2:1 比，则应将其用作背景图像。 这会生成一个粗体的活动卡，它将在时间线中突出显示。 图像会略微变暗，以确保文本在卡上保持可见，在这种情况下，建议您仅使用活动名称，因为较小的文本可能会变得难以阅读。
  * 如果无法将图像裁剪为2:1，则应将其置于活动卡中。  
    * 如果纵横比为方形或纵向，请在卡的右侧定位图像，无边距。
    * 如果纵横比为横向，请将图像锚定卡的右上角。
* 每个活动都需要提供活动名称，应始终显示该名称。
  * 此名称应显示在卡片的左上角，使用大粗体文本选项。 易于识别名称很重要，因为这是在 Cortana 方案中显示活动时用户唯一会看到的部分。 在时间线中显示相同的名称使用户能够更轻松地浏览大量活动。
* 为应用中的所有活动使用相同的视觉样式，以便用户可以在时间线中轻松找到应用的活动。
  * 例如，活动应使用相同的背景色。
* 请谨慎使用补充文本信息。 
  * 避免使用文本填充卡片，只使用补充信息来帮助用户找到正确的活动，或反映状态信息 (例如特定任务) 中的当前进度。

### <a name="content-metadata-guidelines"></a>内容元数据准则

用户活动还可以包含内容元数据，Windows 和 Cortana 使用这些元数据对活动进行分类并生成推断。 然后，可以围绕特定主题分组活动，如 (如果用户正在研究休假) ，则对象 (如果用户要在不同的应用程序和网站上购买特定产品) 或操作 (，则对象。 最好同时表示活动中涉及的名词和动词。 

在下面的示例中，内容元数据 JSON （遵循 [Schema.org](https://schema.org/)的标准）表示方案： "John 扮演了 Steve 的生气鸟瞰"。

```json
// John played angry birds with Steve.
{
  "@context": "http://schema.org",
  "@type": "PlayAction",
  "agent": {
    "@type": "Person",
    "name": "John"
  },
  "object": {
    "@type": "MobileApplication",
    "name": "Angry Birds."
  },
  "participant": {
    "@type": "Person",
    "name": "Steve"
  }
}
```

## <a name="key-apis"></a>关键 API

* [UserActivities 命名空间](/uwp/api/windows.applicationmodel.useractivities)

## <a name="related-topics"></a>相关主题

* [用户活动 (Project 罗马文档) ](/windows/project-rome/user-activities/)
* [自适应卡](/adaptive-cards/)
* [自适应卡片可视化工具，示例](https://adaptivecards.io/)
* [处理 URI 激活](./handle-uri-activation.md)
* [使用 Microsoft Graph、活动源和自适应卡片在任何平台上与客户互动](https://channel9.msdn.com/Events/Connect/2017/B111)
* [Microsoft Graph](https://developer.microsoft.com/graph)